<Window x:Class="Finly.Views.Dialogs.EditLoanDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
        Title="Kredyt"
        WindowStartupLocation="CenterOwner"
        SizeToContent="Width"
        Width="720"
        Height="680"
        MinHeight="680"
        ResizeMode="NoResize"
        WindowStyle="None"
        Background="{DynamicResource App.Background}"
        Foreground="{DynamicResource App.Foreground}"
        Icon="/Assets/Icons/logoFinly.ico">

	<shell:WindowChrome.WindowChrome>
		<shell:WindowChrome CaptionHeight="40"
                            ResizeBorderThickness="0"
                            CornerRadius="0"
                            UseAeroCaptionButtons="False"/>
	</shell:WindowChrome.WindowChrome>

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="40"/>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>

		<!-- Title bar -->
		<Grid Grid.Row="0"
              Background="{DynamicResource TitleBar.Background}"
              MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
			<Grid.ColumnDefinitions>
				<ColumnDefinition/>
				<ColumnDefinition Width="Auto"/>
			</Grid.ColumnDefinitions>

			<TextBlock x:Name="TitleText"
                       Text="Kredyt"
                       VerticalAlignment="Center"
                       Margin="12,0,0,0"
                       Foreground="{DynamicResource App.Foreground}"
                       FontSize="13"
                       shell:WindowChrome.IsHitTestVisibleInChrome="True"/>

			<StackPanel Grid.Column="1" Orientation="Horizontal">
				<Button Width="46" Height="32" Padding="0"
                        Background="Transparent"
                        BorderBrush="{x:Null}"
                        Foreground="{DynamicResource App.Foreground}"
                        Cursor="Hand"
                        FocusVisualStyle="{x:Null}"
                        shell:WindowChrome.IsHitTestVisibleInChrome="True"
                        Click="Close_Click">
					<TextBlock Text="✕" FontSize="12"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"/>
				</Button>
			</StackPanel>
		</Grid>

		<!-- Content -->
		<Border Grid.Row="1"
                Margin="14"
                Padding="16"
                Background="{DynamicResource App.Background}"
                BorderBrush="{DynamicResource Surface.Border}"
                BorderThickness="1"
                CornerRadius="12"
                MinWidth="620">

			<Border Padding="16"
                    Background="{DynamicResource Surface.Background}"
                    BorderBrush="{DynamicResource Surface.Border}"
                    BorderThickness="1"
                    CornerRadius="10">

				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto"/>
						<!-- Header -->
						<RowDefinition Height="14"/>

						<RowDefinition Height="Auto"/>
						<!-- Name -->
						<RowDefinition Height="Auto"/>
						<!-- Principal -->
						<RowDefinition Height="Auto"/>
						<!-- Interest -->
						<RowDefinition Height="Auto"/>
						<!-- Term -->
						<RowDefinition Height="Auto"/>
						<!-- Start date -->

						<RowDefinition Height="18"/>

						<RowDefinition Height="Auto"/>
						<!-- Account + Payment day -->
						<RowDefinition Height="14"/>

						<RowDefinition Height="Auto"/>
						<!-- Schedule attach -->
						<RowDefinition Height="24"/>

						<RowDefinition Height="Auto"/>
						<!-- Footer -->
					</Grid.RowDefinitions>

					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="200"/>
						<ColumnDefinition Width="*"/>
					</Grid.ColumnDefinitions>

					<!-- Header -->
					<Grid Grid.Row="0" Grid.ColumnSpan="2" Margin="0,0,0,6">
						<StackPanel>
							<TextBlock x:Name="HeaderTitleText"
                                       Text="Dodawanie kredytu"
                                       FontSize="18"
                                       FontWeight="Bold"
                                       Foreground="{DynamicResource App.Foreground}"/>
							<TextBlock x:Name="HeaderSubtitleText"
                                       Text="Uzupełnij dane kredytu, a następnie zapisz."
                                       Opacity="0.75"
                                       Foreground="{DynamicResource App.Foreground}"/>
						</StackPanel>
					</Grid>

					<!-- Name -->
					<TextBlock Grid.Row="2" Grid.Column="0"
                               Text="Nazwa kredytu:"
                               VerticalAlignment="Center"
                               Margin="0,0,10,0"/>

					<StackPanel Grid.Row="2" Grid.Column="1">
						<TextBox x:Name="NameTextBox"
                                 MinWidth="320"
                                 TextChanged="AnyFieldChanged"/>
						<TextBlock x:Name="InlineErrorText"
                                   Text=""
                                   Foreground="Tomato"
                                   FontSize="12"
                                   Margin="2,4,0,0"
                                   Visibility="Collapsed"/>
					</StackPanel>

					<!-- Principal -->
					<TextBlock Grid.Row="3" Grid.Column="0"
                               Text="Kwota (kapitał):"
                               VerticalAlignment="Center"
                               Margin="0,10,10,0"/>

					<TextBox x:Name="PrincipalTextBox"
                             Grid.Row="3" Grid.Column="1"
                             Margin="0,10,0,0"
                             VerticalContentAlignment="Center"
                             TextChanged="AnyFieldChanged"/>

					<!-- Interest -->
					<TextBlock Grid.Row="4" Grid.Column="0"
                               Text="Oprocentowanie (%):"
                               VerticalAlignment="Center"
                               Margin="0,10,10,0"/>

					<TextBox x:Name="InterestTextBox"
                             Grid.Row="4" Grid.Column="1"
                             Margin="0,10,0,0"
                             VerticalContentAlignment="Center"
                             TextChanged="AnyFieldChanged"/>

					<!-- Term -->
					<TextBlock Grid.Row="5" Grid.Column="0"
                               Text="Okres (miesiące):"
                               VerticalAlignment="Center"
                               Margin="0,10,10,0"/>

					<TextBox x:Name="TermTextBox"
                             Grid.Row="5" Grid.Column="1"
                             Margin="0,10,0,0"
                             VerticalContentAlignment="Center"
                             TextChanged="AnyFieldChanged"/>

					<!-- Start date -->
					<TextBlock Grid.Row="6" Grid.Column="0"
                               Text="Data rozpoczęcia:"
                               VerticalAlignment="Center"
                               Margin="0,10,10,0"/>

					<DatePicker x:Name="StartDatePicker"
                                Grid.Row="6" Grid.Column="1"
                                Margin="0,10,0,0"
                                SelectedDateChanged="AnyFieldChanged"/>

					<!-- Account + Payment day -->
					<Grid Grid.Row="8" Grid.ColumnSpan="2">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="*"/>
							<ColumnDefinition Width="16"/>
							<ColumnDefinition Width="*"/>
						</Grid.ColumnDefinitions>

						<StackPanel Grid.Column="0">
							<TextBlock Text="Konto spłaty:"
                                       FontSize="12"
                                       Foreground="Gray"/>
							<ComboBox x:Name="AccountCombo"
                                      MinWidth="260"
                                      DisplayMemberPath="AccountName"
                                      SelectedValuePath="Id"/>
						</StackPanel>

						<StackPanel Grid.Column="2">
							<TextBlock Text="Dzień pobrania raty:"
                                       FontSize="12"
                                       Foreground="Gray"/>
							<ComboBox x:Name="PaymentDayCombo" MinWidth="220"/>
						</StackPanel>
					</Grid>

					<!-- Schedule attach -->
					<Grid Grid.Row="10" Grid.ColumnSpan="2">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="Auto"/>
							<ColumnDefinition Width="12"/>
							<ColumnDefinition Width="*"/>
						</Grid.ColumnDefinitions>

						<Button Grid.Column="0"
                                Content="Załącz harmonogram (CSV/PDF)"
                                Style="{StaticResource SecondaryButton}"
                                Click="AttachSchedule_Click"/>

						<TextBlock Grid.Column="2"
                                   x:Name="ScheduleFileText"
                                   Text="Brak pliku"
                                   VerticalAlignment="Center"
                                   Foreground="{DynamicResource App.Foreground}"
                                   Opacity="0.85"
                                   TextTrimming="CharacterEllipsis"/>
					</Grid>

					<!-- Footer -->
					<StackPanel Grid.Row="12"
                                Grid.ColumnSpan="2"
                                Orientation="Horizontal"
                                HorizontalAlignment="Right">
						<Button Content="Anuluj"
                                Style="{StaticResource SecondaryButton}"
                                IsCancel="True"
                                Click="Cancel_Click"/>

						<Button Content="Zapisz"
                                Style="{StaticResource PrimaryButton}"
                                Margin="8,0,0,0"
                                IsDefault="True"
                                Click="Ok_Click"/>
					</StackPanel>

				</Grid>
			</Border>
		</Border>
	</Grid>
</Window>
