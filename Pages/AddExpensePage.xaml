<UserControl x:Class="Finly.Pages.AddExpensePage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d">

    <UserControl.Resources>
        <!-- Prosta karta -->
        <Style x:Key="Card" TargetType="Border">
            <Setter Property="Background" Value="{DynamicResource Surface.Background}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Surface.Border}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding" Value="16"/>
        </Style>
    </UserControl.Resources>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- tytuł -->
            <RowDefinition Height="16"/>
            <RowDefinition Height="Auto"/>
            <!-- pytanie -->
            <RowDefinition Height="12"/>
            <RowDefinition Height="Auto"/>
            <!-- zakładki -->
            <RowDefinition Height="*"/>
            <!-- treść -->
        </Grid.RowDefinitions>

        <!-- Nagłówek -->
        <TextBlock Grid.Row="0"
                   Text="Dodaj"
                   FontSize="20"
                   FontWeight="Bold"
                   Foreground="{DynamicResource App.Foreground}"/>

        <!-- Pytanie -->
        <TextBlock Grid.Row="2"
                   Text="Co chcesz dodać?"
                   FontSize="18"
                   FontWeight="SemiBold"
                   HorizontalAlignment="Center"
                   Foreground="{DynamicResource App.Foreground}"/>

        <!-- Zakładki na środku -->
        <TabControl x:Name="ModeTabs"
                    Grid.Row="4"
                    Width="600"
                    HorizontalAlignment="Center"
                    Background="Transparent"
                    BorderThickness="0"
                    SelectionChanged="ModeTabs_SelectionChanged">

            <TabControl.Resources>
                <!-- WYGLĄD ZAKŁADEK -->
                <Style TargetType="TabItem">
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="FontSize" Value="16"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TabItem">
                                <Border x:Name="Bd"
                                        Background="#202020"
                                        CornerRadius="18"
                                        Padding="24,8"
                                        Margin="4,0"
                                        BorderThickness="1"
                                        BorderBrush="Transparent">
                                    <ContentPresenter HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"
                                                      ContentSource="Header"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <!-- AKTYWNA zakładka – pomarańczowa ramka -->
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="Bd"
                                                Property="BorderBrush"
                                                Value="#FFEB8A00"/>
                                        <Setter TargetName="Bd"
                                                Property="BorderThickness"
                                                Value="2"/>
                                        <Setter Property="Foreground"
                                                Value="White"/>
                                    </Trigger>

                                    <!-- HOVER – delikatna ramka -->
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Bd"
                                                Property="BorderBrush"
                                                Value="#80EB8A00"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>

                <!-- NAGŁÓWKI Z IKONAMI – header dalej jest stringiem -->
                <DataTemplate x:Key="IncomeHeaderTemplate">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <Image Source="/Assets/Icons/przychody.png"
                               Width="20" Height="20"
                               Margin="0,0,6,0"/>
                        <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                    </StackPanel>
                </DataTemplate>

                <DataTemplate x:Key="ExpenseHeaderTemplate">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <Image Source="/Assets/Icons/wydatki.png"
                               Width="20" Height="20"
                               Margin="0,0,6,0"/>
                        <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                    </StackPanel>
                </DataTemplate>

                <DataTemplate x:Key="TransferHeaderTemplate">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <Image Source="/Assets/Icons/transakcje.png"
                               Width="20" Height="20"
                               Margin="0,0,6,0"/>
                        <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                    </StackPanel>
                </DataTemplate>
            </TabControl.Resources>

            <!-- Header jest stringiem, dzięki temu Cancel_Click działa -->
            <TabItem Header="Przychód"
                     HeaderTemplate="{StaticResource IncomeHeaderTemplate}"/>
            <TabItem Header="Wydatek"
                     HeaderTemplate="{StaticResource ExpenseHeaderTemplate}"/>
            <TabItem Header="Transfer"
                     HeaderTemplate="{StaticResource TransferHeaderTemplate}"/>
        </TabControl>

        <!-- =============== TREŚĆ – 3 panele ================= -->

        <!-- ========== WYDATEK ========== -->
        <Border x:Name="ExpensePanel"
                Grid.Row="5"
                Style="{StaticResource Card}"
                Margin="0,16,0,0"
                Visibility="Collapsed">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <!-- 0 kwota -->
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 2 kategoria -->
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 4 data -->
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 6 opis -->
                    <RowDefinition Height="20"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 8 przyciski -->
                </Grid.RowDefinitions>

                <!-- Kwota -->
                <TextBlock Grid.Row="0" Grid.Column="0"
                           Text="Kwota:"
                           VerticalAlignment="Center"
                           Margin="0,0,8,0"/>
                <TextBox x:Name="ExpenseAmountBox"
                         Grid.Row="0" Grid.Column="1"
                         Height="28"/>

                <!-- Kategoria -->
                <TextBlock Grid.Row="2" Grid.Column="0"
                           Text="Kategoria:"
                           VerticalAlignment="Center"
                           Margin="0,0,8,0"/>
                <ComboBox x:Name="ExpenseCategoryBox"
                          Grid.Row="2" Grid.Column="1"
                          Height="28"
                          IsEditable="True"
                          IsTextSearchEnabled="True"
                          StaysOpenOnEdit="True"
                          IsReadOnly="False"/>

                <!-- Data -->
                <TextBlock Grid.Row="4" Grid.Column="0"
                           Text="Data:"
                           VerticalAlignment="Center"
                           Margin="0,0,8,0"/>
                <DatePicker x:Name="ExpenseDatePicker"
                            Grid.Row="4" Grid.Column="1"
                            Height="28"/>

                <!-- Opis -->
                <TextBlock Grid.Row="6" Grid.Column="0"
                           Text="Opis:"
                           VerticalAlignment="Top"
                           Margin="0,4,8,0"/>
                <TextBox x:Name="ExpenseDescBox"
                         Grid.Row="6" Grid.Column="1"
                         Height="80"
                         TextWrapping="Wrap"
                         AcceptsReturn="True"
                         VerticalScrollBarVisibility="Auto"/>

                <!-- Przyciski -->
                <StackPanel Grid.Row="8" Grid.ColumnSpan="2"
                            Orientation="Horizontal"
                            HorizontalAlignment="Right">
                    <Button Content="Dodaj"
                            Margin="0,0,8,0"
                            Style="{StaticResource PrimaryButton}"
                            Click="SaveExpense_Click"/>
                    <Button Content="Anuluj"
                            Click="Cancel_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ========== PRZYCHÓD ========== -->
        <Border x:Name="IncomePanel"
                Grid.Row="5"
                Style="{StaticResource Card}"
                Margin="0,16,0,0"
                Visibility="Collapsed">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <!-- 0 kwota -->
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 2 źródło -->
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 4 kategoria -->
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 6 data -->
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 8 forma -->
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 10 konto -->
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 12 opis -->
                    <RowDefinition Height="20"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 14 przyciski -->
                </Grid.RowDefinitions>

                <!-- Kwota -->
                <TextBlock Grid.Row="0" Grid.Column="0"
                           Text="Kwota:"
                           VerticalAlignment="Center"
                           Margin="0,0,8,0"/>
                <TextBox x:Name="IncomeAmountBox"
                         Grid.Row="0" Grid.Column="1"
                         Height="28"/>

                <!-- Źródło -->
                <TextBlock Grid.Row="2" Grid.Column="0"
                           Text="Źródło:"
                           VerticalAlignment="Center"
                           Margin="0,0,8,0"/>
                <TextBox x:Name="IncomeSourceBox"
                         Grid.Row="2" Grid.Column="1"
                         Height="28"/>

                <!-- Kategoria -->
                <TextBlock Grid.Row="4" Grid.Column="0"
                           Text="Kategoria:"
                           VerticalAlignment="Center"
                           Margin="0,0,8,0"/>
                <ComboBox x:Name="IncomeCategoryBox"
                          Grid.Row="4" Grid.Column="1"
                          Height="28"
                          IsEditable="True"
                          IsTextSearchEnabled="True"
                          StaysOpenOnEdit="True"
                          IsReadOnly="False"/>

                <!-- Data -->
                <TextBlock Grid.Row="6" Grid.Column="0"
                           Text="Data:"
                           VerticalAlignment="Center"
                           Margin="0,0,8,0"/>
                <DatePicker x:Name="IncomeDatePicker"
                            Grid.Row="6" Grid.Column="1"
                            Height="28"/>

                <!-- Forma przychodu -->
                <TextBlock Grid.Row="8" Grid.Column="0"
                           Text="Forma przychodu:"
                           VerticalAlignment="Center"
                           Margin="0,0,8,0"/>
                <ComboBox x:Name="IncomeFormTypeCombo"
                          Grid.Row="8" Grid.Column="1"
                          Height="28"
                          SelectionChanged="IncomeFormTypeCombo_SelectionChanged">
                    <ComboBoxItem Content="Wolna gotówka" Tag="cash_free"/>
                    <ComboBoxItem Content="Odłożona gotówka" Tag="cash_saved"/>
                    <ComboBoxItem Content="Przelew" Tag="transfer"/>
                </ComboBox>

                <!-- Na jakie konto trafia przychód -->
                <Grid x:Name="IncomeAccountRow"
                      Grid.Row="10"
                      Grid.ColumnSpan="2"
                      Visibility="Collapsed">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0"
                               Text="Na jakie konto trafia przychód:"
                               VerticalAlignment="Center"
                               Margin="0,0,8,0"/>
                    <ComboBox x:Name="IncomeAccountCombo"
                              Grid.Column="1"
                              Height="28"/>
                </Grid>

                <!-- Opis -->
                <TextBlock Grid.Row="12" Grid.Column="0"
                           Text="Opis:"
                           VerticalAlignment="Top"
                           Margin="0,4,8,0"/>
                <TextBox x:Name="IncomeDescBox"
                         Grid.Row="12" Grid.Column="1"
                         Height="80"
                         TextWrapping="Wrap"
                         AcceptsReturn="True"
                         VerticalScrollBarVisibility="Auto"/>

                <!-- Przyciski -->
                <StackPanel Grid.Row="14" Grid.ColumnSpan="2"
                            Orientation="Horizontal"
                            HorizontalAlignment="Right">
                    <Button Content="Dodaj"
                            Margin="0,0,8,0"
                            Style="{StaticResource PrimaryButton}"
                            Click="SaveIncome_Click"/>
                    <Button Content="Anuluj"
                            Click="Cancel_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ========== TRANSFER ========== -->
        <Border x:Name="TransferPanel"
                Grid.Row="5"
                Style="{StaticResource Card}"
                Margin="0,16,0,0"
                Visibility="Collapsed">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <!-- 0 z konta -->
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 2 na konto -->
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 4 kategoria -->
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 6 kwota -->
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 8 data -->
                    <RowDefinition Height="20"/>
                    <RowDefinition Height="Auto"/>
                    <!-- 10 przyciski -->
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0"
                           Text="Z konta:"
                           VerticalAlignment="Center"
                           Margin="0,0,8,0"/>
                <ComboBox x:Name="TransferFromBox"
                          Grid.Row="0" Grid.Column="1"
                          Height="28"/>

                <TextBlock Grid.Row="2" Grid.Column="0"
                           Text="Na konto:"
                           VerticalAlignment="Center"
                           Margin="0,0,8,0"/>
                <ComboBox x:Name="TransferToBox"
                          Grid.Row="2" Grid.Column="1"
                          Height="28"/>

                <!-- Kategoria transferu -->
                <TextBlock Grid.Row="4" Grid.Column="0"
                           Text="Kategoria:"
                           VerticalAlignment="Center"
                           Margin="0,0,8,0"/>
                <ComboBox x:Name="TransferCategoryBox"
                          Grid.Row="4" Grid.Column="1"
                          Height="28"
                          IsEditable="True"
                          IsTextSearchEnabled="True"
                          StaysOpenOnEdit="True"
                          IsReadOnly="False"/>

                <!-- Kwota -->
                <TextBlock Grid.Row="6" Grid.Column="0"
                           Text="Kwota:"
                           VerticalAlignment="Center"
                           Margin="0,0,8,0"/>
                <TextBox x:Name="TransferAmountBox"
                         Grid.Row="6" Grid.Column="1"
                         Height="28"/>

                <!-- Data -->
                <TextBlock Grid.Row="8" Grid.Column="0"
                           Text="Data:"
                           VerticalAlignment="Center"
                           Margin="0,0,8,0"/>
                <DatePicker x:Name="TransferDatePicker"
                            Grid.Row="8" Grid.Column="1"
                            Height="28"/>

                <!-- Przyciski -->
                <StackPanel Grid.Row="10" Grid.ColumnSpan="2"
                            Orientation="Horizontal"
                            HorizontalAlignment="Right">
                    <Button Content="Zapisz transfer"
                            Margin="0,0,8,0"
                            Style="{StaticResource PrimaryButton}"
                            Click="SaveTransfer_Click"/>
                    <Button Content="Anuluj"
                            Click="Cancel_Click"/>
                </StackPanel>
            </Grid>
        </Border>

    </Grid>
</UserControl>












